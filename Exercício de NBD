SELECT CLIENTE.COD_CLI, CLIENTE.NOME_CLI, PEDIDO.NUM_PED, PEDIDO.PRAZO_ENTR,CLIENTE.UF
    FROM CLIENTE, PEDIDO
    WHERE CLIENTE.COD_CLI = PEDIDO.CD_CLI
    AND PEDIDO.PRAZO_ENTR > 15
    AND (CLIENTE.UF IN ('SP', 'RJ'));
    
SELECT DISTINCT V.NOME_VEND AS 'NOME DO VENDEDOR', P.PRAZO_ENTR AS 'PRAZO DE ENTREGA'
    FROM VENDEDOR V, PEDIDO P
    WHERE V.COD_VEND = P.CD_VEND 
        AND V.SAL_FIXO > 1000
        AND P.PRAZO_ENTR > 15
    ORDER BY V.NOME_VEND;
    
SELECT DISTINCT C.NOME_CLI , C.COD_CLI, P.CD_CLI, C.UF, PROD.COD_PROD, P.PRAZO_ENTR, PROD.DESC_PROD, IP.CD_PROD ,P.NUM_PED
    FROM CLIENTE C, PRODUTO PROD, PEDIDO P, ITEM_PEDIDO IP
    WHERE C.COD_CLI = P.CD_CLI
        AND P.NUM_PED = IP.NO_PED
        AND IP.CD_PROD = PROD.COD_PROD
        AND PROD.DESC_PROD IN ('CHAPA DE ACO 2.5')
        AND P.PRAZO_ENTR > 15 
        AND C.UF IN ('RJ')
    ORDER BY C.NOME_CLI;


SELECT DESC_PROD
    FROM PRODUTO
    WHERE COD_PROD 
    IN (
    SELECT CD_PROD
        FROM ITEM_PEDIDO
        WHERE QTD_PED = 100
    );
    
SELECT NOME_VEND
    FROM VENDEDOR
    WHERE SAL_FIXO < (
    SELECT AVG(SAL_FIXO)
        FROM VENDEDOR
    );
    
INSERT INTO VENDEDOR (COD_VEND, NOME_VEND, SAL_FIXO, FAIXA_COMISS)
    VALUES ( 16, 'FABIO', 1000 ,'A')
SELECT * FROM VENDEDOR;


INSERT INTO CLIENTE (COD_CLI, NOME_CLI, ENDERECO, CIDADE, CEP, UF)
    SELECT COD_VEND, NOME_VEND, NULL, NULL, NULL, NULL
    FROM VENDEDOR V
    WHERE 3 < (
        SELECT COUNT(*)
        FROM PEDIDO P
        WHERE V.COD_VEND = P.CD_VEND
        );

SELECT * FROM VENDEDOR;


QUESTÕES DA APOSTILA
-- PRIMEIRA QUESTÃO
SELECT NOME_CLI, CIDADE, UF
    FROM CLIENTE
    WHERE UF IN ('RJ') AND CIDADE IN ('NITEROI');

-- SEGUNDA QUESTÃO
SELECT NUM_PED, PRAZO_ENTR
    FROM PEDIDO
    WHERE PRAZO_ENTR <= 15;

-- TERCEIRA QUESTÃO    
SELECT NOME_VEND
    FROM VENDEDOR
    WHERE NOME_VEND NOT LIKE 'A%'; -- A PORCENTAGEM SUBSTITUI VARIAS LETRAS
    
-- QUARTA QUESTÃO
SELECT NOME_CLI, CIDADE, UF
    FROM CLIENTE
    ORDER BY NOME_CLI DESC;
    
-- QUINTA QUESTÃO
SELECT DISTINCT PR.DESC_PROD, SUM(QTD_PED) AS 'QUANTIDADE TOTAL'
    FROM ITEM_PEDIDO IP, PRODUTO PR
    WHERE COD_PROD = CD_PROD AND CD_PROD = 200;

-- VERIFICAÇÃO
SELECT IP.CD_PROD, PR.DESC_PROD, IP.QTD_PED
    FROM ITEM_PEDIDO IP, PRODUTO PR
    WHERE COD_PROD = CD_PROD AND CD_PROD = 200;

-- SEXTA QUESTÃO
SELECT C.NOME_CLI, P.NUM_PED
    FROM CLIENTE C, PEDIDO P
    WHERE C.COD_CLI = P.CD_CLI;

-- SETIMA QUESTÃO
SELECT C.NOME_CLI, C.UF, P.PRAZO_ENTR
    FROM CLIENTE C, PEDIDO P
    WHERE UF IN ('RJ', 'SP') AND PRAZO_ENTR > 15;
    
-- OITAVO QUESTÃO
SELECT P.NUM_PED, P.PRAZO_ENTR, C.NOME_CLI
    FROM PEDIDO P, CLIENTE C
    WHERE COD_CLI = CD_CLI
    ORDER BY PRAZO_ENTR DESC;
    
-- NONA QUESTÃO
SELECT V.NOME_VEND, PR.DESC_PROD, IP.QTD_PED
    FROM PRODUTO PR, ITEM_PEDIDO IP, VENDEDOR V, PEDIDO P
    WHERE COD_VEND = CD_VEND
        AND COD_PROD = CD_PROD
        AND NUM_PED = NO_PED
        AND QTD_PED > 300
        AND DESC_PROD = 'CHAPA DE ACO 2.5';
        
-- DECIMA QUESTÃO
SELECT V.NOME_VEND, COUNT(DISTINCT C.NOME_CLI) AS 'TOTAL DE CLIENTES'
    FROM VENDEDOR V, CLIENTE C, PEDIDO P
    WHERE COD_VEND = CD_VEND
        AND CD_CLI = COD_CLI
    GROUP BY NOME_VEND;
    
-- DECIMA-PRIMEIRA QUESTÃO
SELECT V.NOME_VEND AS 'NOME DO VENDEDOR', C.NOME_CLI AS 'TOTAL DE CLIENTES', C.CIDADE
    FROM VENDEDOR V, CLIENTE C, PEDIDO P
    WHERE COD_VEND = CD_VEND
        AND CD_CLI = COD_CLI
        AND NOME_VEND = 'ANA CRISTINA'
        AND CIDADE IN ('RIO DE JANEIRO', 'NITEROI');

-- VERIFICAÇÃO
SELECT V.NOME_VEND, C.NOME_CLI AS 'TOTAL DE CLIENTES', C.CIDADE
    FROM VENDEDOR V, CLIENTE C, PEDIDO P
    WHERE COD_VEND = CD_VEND
        AND CD_CLI = COD_CLI;

-- DECIMA-SEGUNDA QUESTÃO
SELECT V.NOME_VEND, PR.UNID_PROD, PR.DESC_PROD
    FROM VENDEDOR V, PRODUTO PR, PEDIDO, ITEM_PEDIDO
    WHERE COD_VEND = CD_VEND 
        AND NUM_PED = NO_PED
        AND CD_PROD = COD_PROD
        AND TRIM (UNID_PROD) = 'KG';
